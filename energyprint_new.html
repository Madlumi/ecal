
<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>Energideklaration – Print Layout (Bleed!)</title>
  <style>
    html, body { margin:0; padding:0; font-family:Arial,sans-serif; font-size:10pt; }
    .font-arial { font-family:Arial,sans-serif; font-weight:normal; }
    .font-arial-bold { font-family:Arial,sans-serif; font-weight:bold; }
    .font-helvetica { font-family:Helvetica,Arial,sans-serif; font-weight:normal; }
    .font-helvetica-bold { font-family:Helvetica,Arial,sans-serif; font-weight:bold; }
    #printButton { display:block; margin:2rem auto; padding:1rem 2rem; font-size:1.1rem; background:#3a8f4e; color:#fff; border:none; cursor:pointer; }
    #printButton:hover { background:#287f53; }
    .container { position:absolute; border:1px dashed #888; box-sizing:border-box; padding:0; }
    @media print {
      @page{margin:0; size:148.5mm 210mm;} html,body{margin:0; padding:0; -webkit-print-color-adjust:exact; color-adjust:exact;} #printButton{display:none!important;} .container{page-break-inside:avoid;}
    }
  </style>
</head>
<body>
  <div style="height:10mm;"></div>
  <div style="position:fixed; top:10mm; left:0; width:148.5mm; height:15mm; background:#000;">
    <div class="font-helvetica" style="position:absolute; top:0; left:15mm; font-size:10pt; color:#fff;">sammanfattning av</div>
    <div class="font-helvetica-bold" style="position:absolute; top:5mm; left:15mm; font-size:30pt; color:#fff;">ENERGIDEKLARATION</div>
  </div>
  <div class="container" style="left:8mm; top:29.5mm; width:73mm; height:12.5mm; font-size:13pt;">
    <div class="font-arial">Byggnadens adress</div>
    <div class="font-helvetica">Kommun</div>
  </div>
  <div class="container" style="left:8mm; top:42.5mm; width:73mm; height:13.5mm; font-size:10pt;">
    <div class="font-arial-bold">Nybyggnadsår:</div>
    <div class="font-helvetica-bold">Energideklarations-ID:</div>
  </div>
  <div class="container" style="left:8mm; top:56mm; width:73mm; height:90mm; border:1px solid #000; box-sizing:border-box; overflow:hidden;">
    <div class="font-helvetica-bold" style="font-size:11pt; padding:4px;">ENERGIKLASSER</div>
    <svg id="energyClasses" width="100%" height="calc(100% - 10mm)" viewBox="0 0 73 90" preserveAspectRatio="xMinYMin meet"></svg>
  </div>
  <div class="container" style="left:8mm; top:164mm; width:73mm; height:15.5mm; font-size:10pt;">
    <span class="font-helvetica-bold">Energideklarationen i sin helhet</span><br>
    <span class="font-arial-bold">finns hos byggnadens ägare.</span>
  </div>
  <div class="container" style="left:8mm; top:179.5mm; width:73mm; height:10.5mm; font-size:10pt;">
    <span class="font-arial-bold">För mer information:</span><br>
    <span class="font-helvetica">www.regeringen.ax</span>
  </div>
  <div class="container" style="left:8mm; top:190.5mm; width:73mm; height:9.5mm; font-size:10pt;">
    <span class="font-arial">Sammanfattningen är upprättad enligt Ålands landskapslag (2014:31) om energideklaration för byggnader.</span>
  </div>
  <div class="container" style="left:87.5mm; top:56mm; width:calc(26.5mm - 1.5px); height:26.5mm; overflow:hidden;">
    <svg id="houseSvg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" style="width:calc(26.5mm - 1.5px); height:26.5mm;" preserveAspectRatio="xMinYMin meet">
      <polygon id="houseRoof" stroke="none" />
      <polygon id="houseBody" stroke="none" />
    </svg>
  </div>
  <div class="container" style="left:86mm; top:83.5mm; width:28mm; height:7.5mm; font-size:10pt;">
    <div class="font-arial" style="font-size:8pt; text-align:center;">DENNA BYGGNADS ENERGIKLASS</div>
  </div>
  </div>
  <div class="container" style="left:86mm; top:100mm; width:56.5mm; height:110mm; font-size:10pt;">
    <div style="white-space:nowrap;"><strong>Energiprestanda, primärenergital:</strong></div>
    <div>XXXX kWh/m² och år</div><br>
    <div><strong>Krav vid uppförande av ny byggnad, primärenergital:</strong></div>
    <div>XXXX</div><br>
    <div><strong>Uppvärmningssystem:</strong></div>
    <div>XXXX</div><br>
    <div><strong>Radonmätning:</strong></div>
    <div>XXXX</div><br>
    <div><strong>Ventilationskontroll (OVK):</strong></div>
    <div>XXXX</div><br>
    <div><strong>Åtgärdsförslag:</strong></div>
    <div>XXXX</div><br>
    <div><strong>Energideklarationen är utförd av:</strong></div>
    <div>XXXX</div><br>
    <div><strong>Energideklarationen är giltig till:</strong></div>
    <div>XXXX</div>
  </div>
  <button id="printButton" onclick="window.print()">Skriv ut</button>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const config = {
        labels:['A','B','C','D','E','F','G'],
        colors:['#4caf50','#8bc34a','#cddc39','#ffeb3b','#ffc107','#ff9800','#f44336'],
        highlightIdx:5,
        container:{width:73,height:90},
        margins:{top:10,bottom:5,gap:3},
        arrow:{minNorm:0.2,maxNorm:1.,fontSize:5},
        letterOffset:{x:-4,y:0.5},
        outline:{black:2.5,white:1},
        house:{roofThickness:9,roofGap:6,fontSize:50,letterOffset:{x:0,y:20}}
      };
      // House SVG
      const selColor=config.colors[config.highlightIdx];
      const roof=document.getElementById('houseRoof'),body=document.getElementById('houseBody');
      const rt=config.house.roofThickness,rg=config.house.roofGap;
      roof.setAttribute('points',[[0,50],[50,0],[100,50],[100-rt,50],[50,rt],[rt,50]].map(p=>p.join(',')).join(' '));
      body.setAttribute('points',[[rt,100],[100-rt,100],[100-rt,50+rg],[50,rt+rg],[rt,50+rg]].map(p=>p.join(',')).join(' '));
      roof.setAttribute('fill',selColor);body.setAttribute('fill',selColor);
      // big letter
      const houseSvg=document.getElementById('houseSvg');
      const houseLetter=document.createElementNS(houseSvg.namespaceURI,'text');
      houseLetter.setAttribute('x',(50+config.house.letterOffset.x));
      houseLetter.setAttribute('y',(55+config.house.letterOffset.y));
      houseLetter.setAttribute('font-size',config.house.fontSize+'pt');
      houseLetter.setAttribute('fill','#000');
      houseLetter.setAttribute('font-weight','bold');
      houseLetter.setAttribute('text-anchor','middle');
      houseLetter.setAttribute('dominant-baseline','middle');
      houseLetter.textContent=config.labels[config.highlightIdx];
      houseSvg.appendChild(houseLetter);
      // Arrows
      const svg=document.getElementById('energyClasses'),n=config.labels.length;
      const hAvail=config.container.height-config.margins.top-config.margins.bottom-config.margins.gap*(n-1);
      const arrowH=hAvail/n;
      // tipW for 30° slopes: tipW = arrowH/2 / tan(30°) = arrowH*(√3/2)
      const tipW=arrowH*Math.sqrt(3)/2;
      // outlines
      const sy=config.margins.top+config.highlightIdx*(arrowH+config.margins.gap);
      const wSel=config.arrow.minNorm*config.container.width+config.highlightIdx*((config.arrow.maxNorm-config.arrow.minNorm)*config.container.width/(n-1));
      const selPts=[[0,sy],[wSel,sy],[wSel+tipW,sy+arrowH/2],[wSel,sy+arrowH],[0,sy+arrowH]].map(p=>p.join(',')).join(' ');
      [{color:'#000',w:config.outline.black},{color:'#fff',w:config.outline.white}].forEach(o=>{
        const p=document.createElementNS(svg.namespaceURI,'polygon');
        p.setAttribute('points',selPts);p.setAttribute('fill','none');p.setAttribute('stroke',o.color);p.setAttribute('stroke-width',o.w);
        svg.appendChild(p);
      });
      // draw
      config.labels.forEach((lbl,i)=>{
        const y=config.margins.top+i*(arrowH+config.margins.gap);
        const w=config.arrow.minNorm*config.container.width+i*((config.arrow.maxNorm-config.arrow.minNorm)*config.container.width/(n-1));
        const pts=[[0,y],[w,y],[w+tipW,y+arrowH/2],[w,y+arrowH],[0,y+arrowH]].map(p=>p.join(',')).join(' ');
        const poly=document.createElementNS(svg.namespaceURI,'polygon');poly.setAttribute('points',pts);poly.setAttribute('fill',config.colors[i]);svg.appendChild(poly);
        const t=document.createElementNS(svg.namespaceURI,'text');
        t.setAttribute('x',(w+tipW/2+config.letterOffset.x));
        t.setAttribute('y',(y+arrowH/2+config.letterOffset.y));
        t.setAttribute('font-size',config.arrow.fontSize+'pt');
        t.setAttribute('fill','#000');t.setAttribute('text-anchor','middle');t.setAttribute('dominant-baseline','middle');
        t.textContent=lbl;svg.appendChild(t);
      });
    });
  </script>
</body>
</html>
